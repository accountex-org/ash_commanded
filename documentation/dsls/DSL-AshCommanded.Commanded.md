<!--
This file was generated by Spark. Do not edit it by hand.
-->
# AshCommanded.Commanded

The DSL extension for using Commanded with Ash resources.

This extension provides the ability to define commands, events, projections, and event handlers using Ash resources,
and integrates with Commanded to provide CQRS and Event Sourcing patterns.

## Usage

```elixir
defmodule MyApp.User do
  use Ash.Resource,
    extensions: [AshCommanded.Commanded.Dsl]
    
  commanded do
    commands do
      command :register_user do
        fields([:id, :email, :name])
        identity_field(:id)
      end
    end
    
    events do
      event :user_registered do
        fields([:id, :email, :name])
      end
    end
    
    projections do
      projection :user_registered do
        changes(%{status: :active})
      end
    end
    
    event_handlers do
      handler :user_registered_notification do
        events [:user_registered]
        action fn event, _metadata ->
          MyApp.Notifications.send_welcome_email(event.email)
          :ok
        end
      end
    end
  end
end
```


## commanded
Configure CQRS and Event Sourcing with Commanded

### Nested DSLs
 * [commands](#commanded-commands)
   * command
   * transform_params
   * validate_params
   * transaction
 * [events](#commanded-events)
   * event
 * [projections](#commanded-projections)
   * projection
 * [event_handlers](#commanded-event_handlers)
   * handler
 * [application](#commanded-application)




### commanded.commands
Define commands that trigger state changes in the resource

### Nested DSLs
 * [command](#commanded-commands-command)
 * [transform_params](#commanded-commands-transform_params)
 * [validate_params](#commanded-commands-validate_params)
 * [transaction](#commanded-commands-transaction)





### Options

| Name | Type | Default | Docs |
|------|------|---------|------|
| [`commands`](#commanded-commands-commands){: #commanded-commands-commands } | `list(any)` | `[]` | The commands that can be performed on this resource |
| [`middleware`](#commanded-commands-middleware){: #commanded-commands-middleware } | `list(atom \| {atom, any})` | `[]` | List of middleware to apply to all commands in this resource. Each entry can be a module or {module, options} tuple. |
| [`default_repo`](#commanded-commands-default_repo){: #commanded-commands-default_repo } | `atom` |  | The default repository to use for transactions |
| [`default_transaction_timeout`](#commanded-commands-default_transaction_timeout){: #commanded-commands-default_transaction_timeout } | `integer` |  | Default transaction timeout in milliseconds |
| [`default_transaction_isolation_level`](#commanded-commands-default_transaction_isolation_level){: #commanded-commands-default_transaction_isolation_level } | `:read_committed \| :repeatable_read \| :serializable` |  | Default transaction isolation level |



### commanded.commands.command
```elixir
command name
```








### Arguments

| Name | Type | Default | Docs |
|------|------|---------|------|
| [`name`](#commanded-commands-command-name){: #commanded-commands-command-name .spark-required} | `atom` |  | The name of the command, used for reference in the DSL |
### Options

| Name | Type | Default | Docs |
|------|------|---------|------|
| [`fields`](#commanded-commands-command-fields){: #commanded-commands-command-fields .spark-required} | `list(atom)` |  | The fields that the command accepts, which should correspond to attributes in the resource |
| [`identity_field`](#commanded-commands-command-identity_field){: #commanded-commands-command-identity_field } | `atom` |  | The field that uniquely identifies the aggregate instance this command targets |
| [`action`](#commanded-commands-command-action){: #commanded-commands-command-action } | `atom` |  | The Ash action to call when handling this command. Defaults to the command name. |
| [`action_type`](#commanded-commands-command-action_type){: #commanded-commands-command-action_type } | `:create \| :update \| :destroy \| :read \| :custom` |  | The type of action (:create, :update, :destroy, :read, or :custom). If not specified, inferred from the action name. |
| [`param_mapping`](#commanded-commands-command-param_mapping){: #commanded-commands-command-param_mapping } | `map \| any` |  | A map or function for transforming command fields to action params. |
| [`command_name`](#commanded-commands-command-command_name){: #commanded-commands-command-command_name } | `atom` |  | Override the auto-generated command module name |
| [`handler_name`](#commanded-commands-command-handler_name){: #commanded-commands-command-handler_name } | `atom` |  | Override the auto-generated handler function name |
| [`autogenerate_handler?`](#commanded-commands-command-autogenerate_handler?){: #commanded-commands-command-autogenerate_handler? } | `boolean` | `true` | Whether to autogenerate a handler for this command |
| [`middleware`](#commanded-commands-command-middleware){: #commanded-commands-command-middleware } | `list(atom \| {atom, any})` |  | List of middleware to apply to this command. Each entry can be a module or {module, options} tuple. |
| [`transforms`](#commanded-commands-command-transforms){: #commanded-commands-command-transforms } | `list(any)` |  | List of parameter transformations to apply (used internally) |
| [`validations`](#commanded-commands-command-validations){: #commanded-commands-command-validations } | `list(any)` |  | List of parameter validations to apply (used internally) |
| [`in_transaction?`](#commanded-commands-command-in_transaction?){: #commanded-commands-command-in_transaction? } | `boolean` | `false` | Whether to execute the command in a transaction |
| [`repo`](#commanded-commands-command-repo){: #commanded-commands-command-repo } | `atom` |  | The repository to use for transactions (required if in_transaction? is true) |
| [`transaction_timeout`](#commanded-commands-command-transaction_timeout){: #commanded-commands-command-transaction_timeout } | `integer` |  | Transaction timeout in milliseconds |
| [`transaction_isolation_level`](#commanded-commands-command-transaction_isolation_level){: #commanded-commands-command-transaction_isolation_level } | `:read_committed \| :repeatable_read \| :serializable` |  | Transaction isolation level |
| [`include_metadata?`](#commanded-commands-command-include_metadata?){: #commanded-commands-command-include_metadata? } | `boolean` | `true` | Whether to include command metadata in the action context |
| [`include_aggregate?`](#commanded-commands-command-include_aggregate?){: #commanded-commands-command-include_aggregate? } | `boolean` | `true` | Whether to include the aggregate state in the action context |
| [`include_command?`](#commanded-commands-command-include_command?){: #commanded-commands-command-include_command? } | `boolean` | `true` | Whether to include the command itself in the action context |
| [`context_prefix`](#commanded-commands-command-context_prefix){: #commanded-commands-command-context_prefix } | `atom` |  | An optional prefix for context keys to prevent collisions |
| [`static_context`](#commanded-commands-command-static_context){: #commanded-commands-command-static_context } | `map` |  | Static context values to include in every action execution |





### Introspection

Target: `AshCommanded.Commanded.Command`

### commanded.commands.transform_params









### Options

| Name | Type | Default | Docs |
|------|------|---------|------|
| [`map`](#commanded-commands-transform_params-map){: #commanded-commands-transform_params-map } | `list(any)` |  | Maps a field from one name to another |
| [`cast`](#commanded-commands-transform_params-cast){: #commanded-commands-transform_params-cast } | `list(any)` |  | Casts a field to a specific type |
| [`compute`](#commanded-commands-transform_params-compute){: #commanded-commands-transform_params-compute } | `list(any)` |  | Computes a field value using a function |
| [`transform`](#commanded-commands-transform_params-transform){: #commanded-commands-transform_params-transform } | `list(any)` |  | Transforms a field value using a function |
| [`default`](#commanded-commands-transform_params-default){: #commanded-commands-transform_params-default } | `list(any)` |  | Sets a default value for a field |
| [`custom`](#commanded-commands-transform_params-custom){: #commanded-commands-transform_params-custom } | `list(any)` |  | Applies a custom transformation function to the entire params map |





### Introspection

Target: `AshCommanded.Commanded.ParameterTransformer`

### commanded.commands.validate_params









### Options

| Name | Type | Default | Docs |
|------|------|---------|------|
| [`validate`](#commanded-commands-validate_params-validate){: #commanded-commands-validate_params-validate } | `list(any)` |  | Validates a field against rules or using a function |





### Introspection

Target: `AshCommanded.Commanded.ParameterValidator`

### commanded.commands.transaction









### Options

| Name | Type | Default | Docs |
|------|------|---------|------|
| [`enabled?`](#commanded-commands-transaction-enabled?){: #commanded-commands-transaction-enabled? } | `boolean` | `true` | Whether transactions are enabled for this command |
| [`repo`](#commanded-commands-transaction-repo){: #commanded-commands-transaction-repo } | `atom` |  | The repository to use for transactions (required if enabled) |
| [`timeout`](#commanded-commands-transaction-timeout){: #commanded-commands-transaction-timeout } | `integer` |  | Transaction timeout in milliseconds |
| [`isolation_level`](#commanded-commands-transaction-isolation_level){: #commanded-commands-transaction-isolation_level } | `:read_committed \| :repeatable_read \| :serializable` |  | Transaction isolation level |





### Introspection

Target: `AshCommanded.Commanded.Transaction`


### commanded.events
Define events that are emitted by commands

### Nested DSLs
 * [event](#commanded-events-event)





### Options

| Name | Type | Default | Docs |
|------|------|---------|------|
| [`events`](#commanded-events-events){: #commanded-events-events } | `list(any)` | `[]` | The events that can be emitted by commands in this resource |



### commanded.events.event
```elixir
event name
```








### Arguments

| Name | Type | Default | Docs |
|------|------|---------|------|
| [`name`](#commanded-events-event-name){: #commanded-events-event-name .spark-required} | `atom` |  | The name of the event, used for reference in the DSL |
### Options

| Name | Type | Default | Docs |
|------|------|---------|------|
| [`fields`](#commanded-events-event-fields){: #commanded-events-event-fields .spark-required} | `list(atom)` |  | The fields that the event contains, which should correspond to attributes in the resource |
| [`event_name`](#commanded-events-event-event_name){: #commanded-events-event-event_name } | `atom` |  | Override the auto-generated event module name |





### Introspection

Target: `AshCommanded.Commanded.Event`


### commanded.projections
Define how events affect the resource state

### Nested DSLs
 * [projection](#commanded-projections-projection)





### Options

| Name | Type | Default | Docs |
|------|------|---------|------|
| [`projections`](#commanded-projections-projections){: #commanded-projections-projections } | `list(any)` | `[]` | The projections that define how events affect resource state |



### commanded.projections.projection
```elixir
projection name
```








### Arguments

| Name | Type | Default | Docs |
|------|------|---------|------|
| [`name`](#commanded-projections-projection-name){: #commanded-projections-projection-name .spark-required} | `atom` |  | The name of the projection, typically matching the event name |
### Options

| Name | Type | Default | Docs |
|------|------|---------|------|
| [`action`](#commanded-projections-projection-action){: #commanded-projections-projection-action .spark-required} | `atom` |  | The Ash action to call when handling this event (e.g., :create, :update, :destroy) |
| [`changes`](#commanded-projections-projection-changes){: #commanded-projections-projection-changes .spark-required} | `map \| any` |  | The changes to apply to the resource when the event is received. Can be a static map or a function (in quoted form) that accepts the event and returns a map. |
| [`event_name`](#commanded-projections-projection-event_name){: #commanded-projections-projection-event_name } | `atom` |  | The name of the event this projection listens for. Defaults to the projection name. |
| [`autogenerate?`](#commanded-projections-projection-autogenerate?){: #commanded-projections-projection-autogenerate? } | `boolean` | `true` | Whether to autogenerate a projector for this projection |





### Introspection

Target: `AshCommanded.Commanded.Projection`


### commanded.event_handlers
Define general purpose handlers that respond to events

### Nested DSLs
 * [handler](#commanded-event_handlers-handler)





### Options

| Name | Type | Default | Docs |
|------|------|---------|------|
| [`event_handlers`](#commanded-event_handlers-event_handlers){: #commanded-event_handlers-event_handlers } | `list(any)` | `[]` | The handlers that respond to events without necessarily updating resource state |



### commanded.event_handlers.handler
```elixir
handler name
```








### Arguments

| Name | Type | Default | Docs |
|------|------|---------|------|
| [`name`](#commanded-event_handlers-handler-name){: #commanded-event_handlers-handler-name .spark-required} | `atom` |  | The name of the event handler |
### Options

| Name | Type | Default | Docs |
|------|------|---------|------|
| [`events`](#commanded-event_handlers-handler-events){: #commanded-event_handlers-handler-events .spark-required} | `list(atom)` |  | List of event names this handler will subscribe to |
| [`handler_name`](#commanded-event_handlers-handler-handler_name){: #commanded-event_handlers-handler-handler_name } | `atom` |  | Override the auto-generated handler module name |
| [`action`](#commanded-event_handlers-handler-action){: #commanded-event_handlers-handler-action } | `any \| atom` |  | Action to perform when handling the event. Can be an Ash action name or a quoted function that receives the event and returns a result. |
| [`publish_to`](#commanded-event_handlers-handler-publish_to){: #commanded-event_handlers-handler-publish_to } | `atom \| String.t \| list(atom \| String.t)` |  | Optional PubSub topic(s) to publish the event to |
| [`idempotent`](#commanded-event_handlers-handler-idempotent){: #commanded-event_handlers-handler-idempotent } | `boolean` | `false` | Whether the handler is idempotent and can safely handle the same event multiple times |
| [`autogenerate?`](#commanded-event_handlers-handler-autogenerate?){: #commanded-event_handlers-handler-autogenerate? } | `boolean` | `true` | Whether to autogenerate a handler for this configuration |





### Introspection

Target: `AshCommanded.Commanded.EventHandler`


### commanded.application
Configure the Commanded application






### Options

| Name | Type | Default | Docs |
|------|------|---------|------|
| [`otp_app`](#commanded-application-otp_app){: #commanded-application-otp_app .spark-required} | `atom` |  | The OTP application name to use for configuration |
| [`event_store`](#commanded-application-event_store){: #commanded-application-event_store .spark-required} | `atom \| keyword \| {atom, keyword}` |  | The event store adapter to use (e.g., Commanded.EventStore.Adapters.EventStore) |
| [`pubsub`](#commanded-application-pubsub){: #commanded-application-pubsub } | `atom` | `:local` | The pub/sub adapter to use (:local, :phoenix) |
| [`registry`](#commanded-application-registry){: #commanded-application-registry } | `atom` | `:local` | The registry adapter to use (:local, :global) |
| [`snapshotting`](#commanded-application-snapshotting){: #commanded-application-snapshotting } | `boolean` | `false` | Whether to enable aggregate snapshotting |
| [`snapshot_threshold`](#commanded-application-snapshot_threshold){: #commanded-application-snapshot_threshold } | `integer` | `100` | Number of events to process before taking a snapshot |
| [`snapshot_version`](#commanded-application-snapshot_version){: #commanded-application-snapshot_version } | `integer` | `1` | The version of the snapshot schema |
| [`snapshot_store`](#commanded-application-snapshot_store){: #commanded-application-snapshot_store } | `atom \| map` |  | Optional custom snapshot store module or configuration |
| [`include_supervisor?`](#commanded-application-include_supervisor?){: #commanded-application-include_supervisor? } | `boolean` | `false` | Whether to include a supervisor for the application |
| [`prefix`](#commanded-application-prefix){: #commanded-application-prefix } | `String.t` |  | Application module prefix for generated code |









<style type="text/css">.spark-required::after { content: "*"; color: red !important; }</style>
